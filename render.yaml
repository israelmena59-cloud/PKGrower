services:
  - type: web
    name: pkgrower
    env: node
    plan: free
    # Install Chrome for Puppeteer during build
    buildCommand: |
      npm install && npm run build && cd backend && npm install && npx puppeteer browsers install chrome
    startCommand: cd backend && node index.js
    envVars:
      - key: VITE_API_URL
        value: https://pkgrower.onrender.com
      - key: TUYA_ACCESS_KEY
        sync: false
      - key: TUYA_SECRET_KEY
        sync: false
      - key: TUYA_DEVICE_ID
        sync: false
      - key: API_KEY
        sync: false
      # Puppeteer configuration
      - key: PUPPETEER_CACHE_DIR
        value: /opt/render/.cache/puppeteer
      - key: PUPPETEER_HEADLESS
        value: "true"
